{"version":3,"sources":["../../src/main/index.ts"],"names":[],"mappings":";AAEA,qEAA2D;AAC3D,iDAAwC;AACxC,2DAAiD;AACjD,uDAAqD;AAiCjD,6DAAe;AAhCnB,yDAAuD;AAiCnD,gEAAgB;AAhCpB,mDAAiD;AAiC7C,uDAAa;AA7BjB,6DAA2D;AAkCvD,sEAAkB;AAjCtB,6DAA2D;AAkCvD,sEAAkB;AAjCtB,6DAA2D;AAkCvD,sEAAkB;AAjCtB,uDAAqD;AAkCjD,6DAAe;AAjCnB,mDAA+C;AAE/C,6CAA4C;AAgCxC,gDAAW;AA9Bf,mBAA0B,sBAA8C,EAAE,mBAA6B;IACnG,IAAI,SAAS,GAAc,sBAAsB,CAAC,SAAS,CAAC;IAC5D,IAAI,eAAe,GAAoB,SAAS,CAAC,GAAG,CAAC,0CAAe,CAAC,CAAC;IACtE,IAAI,MAAM,GAAW,SAAS,CAAC,GAAG,CAAC,uBAAM,CAAC,CAAC;IAC3C,IAAI,UAAU,GAAe,SAAS,CAAC,GAAG,CAAC,gCAAU,CAAC,CAAC;IACvD,IAAI,OAAO,GAAiB,SAAS,CAAC,GAAG,CAAC,8BAAY,CAAC,CAAC;IACxD,IAAI,eAAe,GAAoB,IAAI,kCAAe,CAAC,eAAe,EAAE,UAAU,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;IACzG,SAAS,CAAC,gBAAgB,CAAC,kCAAe,EAAE,eAAe,CAAC,CAAC;IAC7D,EAAE,CAAC,CAAC,mBAAmB,CAAC,CAAC,CAAC;QACtB,mBAAmB,CAAC,eAAe,CAAC,CAAC;IACzC,CAAC;IACD,MAAM,CAAC,eAAe,CAAC,YAAY,CAAC,IAAI,wCAAkB,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,UAAA,OAAO;QAC5E,MAAM,CAAC,OAAO,CAAC,GAAG,CAAS,eAAe,CAAC,aAAa,CAAC,4BAA4B,CAAC,CAAC,IAAI,CAAC,UAAA,KAAK;YAC7F,MAAM,CAAC,eAAe,CAAC,YAAY,CAAC,IAAI,kCAAe,CAAC,KAAK,CAAC,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,UAAA,aAAa,IAAI,OAAA,eAAe,CAAC,oBAAoB,EAAE,EAAtC,CAAsC,CAAC,CAAC;IAC3E,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,UAAA,OAAO,IAAI,OAAA,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,EAAtB,CAAsB,CAAC,CAAC;AACrD,CAAC;AAhBD,8BAgBC","file":"index.js","sourcesContent":["import { FrameworkConfiguration } from \"aurelia-framework\";\nimport { Container } from \"aurelia-dependency-injection\";\nimport { EventAggregator } from \"aurelia-event-aggregator\";\nimport { Router } from \"aurelia-router\";\nimport { HttpClient } from \"aurelia-http-client\";\nimport { SecurityContext } from \"./security-context\";\nimport { AuthorizeRequest } from \"./authorize-request\";\nimport { AuthorizeStep } from \"./authorize-step\";\nimport { Principal } from \"./principal\";\nimport { SecurityRole } from \"./security-role\";\nimport { Credential } from \"./credential\";\nimport { ImplicitCredential } from \"./implicit-credential\";\nimport { PasswordCredential } from \"./password-credential\";\nimport { ProviderCredential } from \"./provider-credential\";\nimport { TokenCredential } from \"./token-credential\";\nimport { LocalStorage } from \"aurelia-storage\";\nimport { Tenant } from \"./tenant\";\nimport { Preferences } from \"./preferences\";\n\nexport function configure(frameworkConfiguration: FrameworkConfiguration, pluginConfiguration: Function) {\n    let container: Container = frameworkConfiguration.container;\n    let eventAggregator: EventAggregator = container.get(EventAggregator);\n    let router: Router = container.get(Router);\n    let httpClient: HttpClient = container.get(HttpClient);\n    let storage: LocalStorage = container.get(LocalStorage);\n    let securityContext: SecurityContext = new SecurityContext(eventAggregator, httpClient, router, storage);\n    container.registerInstance(SecurityContext, securityContext);\n    if (pluginConfiguration) {\n        pluginConfiguration(securityContext);\n    }\n    return securityContext.authenticate(new ImplicitCredential()).then(null, failure => {\n        return storage.get<string>(securityContext.configuration.authorizationTokenStorageKey).then(token => {\n            return securityContext.authenticate(new TokenCredential(token));\n        }).then(null, tokenNotValid => securityContext.deleteAndRevokeToken());\n    }).then(null, failure => console.debug(failure));\n}\n\nexport {\n    SecurityContext,\n    AuthorizeRequest,\n    AuthorizeStep,\n    Tenant,\n    Principal,\n    SecurityRole,\n    Credential,\n    ImplicitCredential,\n    PasswordCredential,\n    ProviderCredential,\n    TokenCredential,\n    Preferences\n};\n"]}